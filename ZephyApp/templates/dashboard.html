{% extends "base.html" %}

{% block title %}Dashboard Principal{% endblock %}
{% block content %}
<style>
    .bg-disponible {
      background-color: #a3c4f7;
      color: black !important;
    }
    .bg-ocupado {
      background-color: #5371d6 ;
      color: white !important;
    }
    .bg-no-disponible {
      background-color: #dfa0b5;
      color: black !important;
    }
  </style>
<h1 class="display-5 text-center">Dashboard Principal</h1>
<div class="container mt-4">
    <div class="row justify-content-end">
        <div class="col-md-6">
            <div class="row">
                <div class="col-md-4">
                    <a href="{% url 'box_list' %}?estado=1" class="text-decoration-none">
                        <div class="card text-black mb-3 bg-disponible" >
                            <div class="card-header">Boxes Disponibles</div>
                            <div class="card-body">
                                <h5 class="card-title">{{ box_disponibles }}</h5>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="{% url 'box_list' %}?estado=2" class="text-decoration-none">
                        <div class="card text-black mb-3 bg-ocupado" >
                            <div class="card-header">Boxes Ocupados</div>
                            <div class="card-body">
                                <h5 class="card-title">{{ box_ocupados }}</h5>
                            </div>
                        </div>
                    </a>
                </div>
                <div class="col-md-4">
                    <a href="{% url 'box_list' %}?estado=3" class="text-decoration-none">
                        <div class="card text-black mb-3 bg-no-disponible" >
                            <div class="card-header">Boxes No Disponibles</div>
                            <div class="card-body">
                                <h5 class="card-title">{{ box_no_disponibles }}</h5>
                            </div>
                        </div>
                    </a>
                </div>
            </div>
            <div class="text-center">
                <a href="{% url 'box_list' %}" class="btn btn-primary">Detalle</a>
            </div>
        </div>
    </div>
    <div class="row justify-content-end">
        <div class="col-md-6">
            <h2 class="text-center">Cantidad de boxes por estado</h2>

        <div class="col-md-6 offset-md-4">
            <canvas id="boxChart"></canvas>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const ctx = document.getElementById('boxChart').getContext('2d');
    const boxChart = new Chart(ctx, {
        type: 'pie',
        data: {
            labels: ['Disponibles', 'Ocupados', 'No Disponibles'],
            datasets: [{
                data: [{{ box_disponibles }}, {{ box_ocupados }}, {{ box_no_disponibles }}],
                backgroundColor: ['#a3c4f7', '#5371d6', '#dfa0b5'],
                borderColor: ['#ffffff', '#ffffff', '#ffffff'],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'top',
                    align: 'end'
                },
                tooltip: {
                    callbacks: {
                        label: function(tooltipItem) {
                            const value = tooltipItem.raw;
                            return `${tooltipItem.label}: ${value}`;
                        }
                    }
                }
            }
        }
    });
</script>

{% endblock %}